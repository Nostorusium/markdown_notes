# 补充

## 物理层

当视野来到了物理层，我们所见之物全然没有任何高层抽象，只有赤裸的物理工程实践。  
信息传输问题从高层抽象的网络工程设计还原为了最基础的信息通信问题。  

### 码元，波特率，比特率

信息在一条物理信道上传输，它被信号承载。信号可以是离散的数字信号，也可以是连续的模拟信号。在物理/数学上，他们都表现为波，模拟信号为正弦波，数字信号为方波。  

如何使用波来传递信息呢？就好比编码，我们也可以使用几个比特编码几个波形。  
2bit能表示4个波形，此时一个特定的波形就承载了2个比特的信息。我们使用术语**码元**来称呼这样的波形。  

数据的传输速率就变成了单位时间能放出这样波形的个数。我们使用**波特率**表示单位时间内传输的码元个数。  

而当信息还原为比特，我们就得到了**比特率**，它在数值上为 **波特率*logN**

### 信息论，奈氏准则与香农定理

香农的信息论诉诸了一个道理：任何形式的**信息**都不能无限快的传播。  
奈氏准则与香农定理从两个不同角度阐述了他们的理由。

**1. 奈氏定理**

数学上的各类关于波的叠加与变换被应用于模拟信号的实际传播：即多个正弦波的叠加。接收方在接受这样的信号需要进行采样，以一定频率进行采样并尽可能恢复原始的模拟信号。**采样定理**给出了采样频率应该大于模拟信号中各个信号分量重最高频率的两倍。这是技术上为了避免无法确定信号波形提出的。  

这意味着如果信号频率过高，接收方以既定的采样频率不能很好的确定码元之间的界限，即码间串扰。为了避免这种情况发生，发送码元的速率应该有所限制。  

奈奎斯特给出：理想信道下，极限码元传输速率为**2W**(两倍带宽)，对应比特率**2WlogN**  
要注意，这是因为码元，或者说波形的传输问题招致的**波特率**限制，而并没有对每个波形承载的比特作出限制。也意味着，如果编码方案足够优秀使得一个码元能承受更多的比特，那就可以提高比特率。

**2. 香农定理**

奈氏定理揭示了码元在实际传输中遭遇的问题，它是在理想信道中设想的，它给出了波特率限制。  
香农则给出了在有噪声信道下，信息传输的比特率限制：
$Capacity = W*log_2(1+S/N)$
其中，S/N为信噪比，它还可以表示为**分贝值**：$10*log_{10}(S/N)$，单位为db。  

香农定理揭示了由于实际存在的噪声，我们无法拥有理想信道，也无法在理想信道下通过提高码元比特承载量的方式无限快地传输数据。

## 滑动窗口

值得说明的是，滑动窗口只是一种指导思想，而不是某种特定的具体实现。  

提到**广义的滑动窗口**，不管是GBN还是SR，都按照具体编号判断接受的分组。此处我们使用广义术语：**分组**，因为他可以被实现在不同层。在TCP/IP下往往在传输层进行流量控制，所以此时这个分组是**传输层报文**。在ISO下，往往在链路层进行流量控制，此时这个分组是**帧**。  

流量控制中涉及到一个特殊情形：即接收方接受了分组，并向后推进了窗口，同时返回ACK给发送方。而发给发送方的ACK中途丢失，导致接收方的窗口已向后推进，发送方迟迟收不到ACK而阻塞窗口直到定时器重传未确认的帧。如下图：

```
suppose Ws = 5
sender:         (0 1 2 3 4) 5 6 7 0 1 2 3 4 5 6 7
ACK:             x x x x x
receiver:        0 1 2 3 4 (5 6 7 0 1 2 3 4 5 6 7 ?)
```

如图的情景中，发送方因为迟迟收不到ACK，最终重新传送帧 0~4 。而要注意此时接收方的窗口已经向后递进，在此情景下的序号范围里，我们应该控制接收方的窗口大小，至少保证窗口内的序号不会与重传的 0~4 冲突。  

因此接收方窗口只能限制在5 6 7，决不能越过这个范围包括后续的0,1,2...不然将导致重传的旧0,1,2与接收方窗口内待接收的新0,1,2...产生序号冲突。  

在这个例子中，接收方的窗口将被限制在3。  
将这个例子一般化，我们会得到：发送窗口 + 接收窗口 不得超过 序号范围。
假如我们有n比特编号，那么序号值将为 $[0,2^n-1]$ ，一共 $2^n$ 个数。  
我们得到 发送窗口 + 接收窗口 ≤ $2^n$。  

现在我们得到了一般的滑动窗口要遵循的序号要求。特别地，我们可以看看在GBN与SR情况下他们的序号情况：

1. GBN
   如果用滑动窗口来解释GBN，那么它可以被理解为一个发送窗口为n，接受窗口为1的滑动窗口协议。遵循n+1 ≤ 序号范围。
2. SR
   同理，SR可以被理解为一个发送窗口等于接收窗口的滑动窗口协议。遵循n+n ≤ 序号范围，即所谓的n至少为序号范围的一半。

